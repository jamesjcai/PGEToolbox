function [CLmax,CL]=snp_complike(genodata,markinfo)
%SNP_COMPLIKE  - composite likelihood of SNPs
%  Syntax: [CLmax,CL]=snp_complike(genodata,markinfo)
%
%http://www.genome.org/cgi/content/full/15/11/1566
%C3 gene
%http://pga.gs.washington.edu/data/c3/comp3.freq.txt
%CLmax - maximized composite likelihood
%CL - composite likelihood

% Population Genetics and Evolution Toolbox (PGEToolbox)
% Author: James Cai
% Email: jcai@tamu.edu
% 
% $LastChangedDate: 2013-01-06 13:39:38 -0600 (Sun, 06 Jan 2013) $
% $LastChangedRevision: 331 $
% $LastChangedBy: jcai $

ffreq=snp_maf(genodata);
pos=markinfo.pos;

%ffreq=[0.04 0.04 0.04 0.09 0 0.05 0.19 0.02 0.05 0.02 0.02 0.33 0.33 0.33 0.02 0.38 0.38 0.1 0.17 0.02 0.28 0.07 0.18 0.21 0.07 0.04 0.02 0.23 0.04 0.02 0.09 0.04 0.09 0.04 0.03 0.05 0.17 0 0 0 0 0.04 0 0.2 0 0.08 0.33 0.02 0.24 0 0.04 0.16 0.02 0.04 0.2 0.3 0.15 0.21 0.04 0.21 0.02 0.02 0.54 0.26 0.04 0.04 0.04 0.02 0.02 0.05 0.02 0.06 0.04 0.11 0.04 0.05 0 0.06 0.06 0.02 0.04 0.05 0.1 0 0.12 0.03 0.11 0.03 0.13 0.13 0.2 0.25 0.07 0.23 0.23 0.25 0.25 0.25 0.25 0.02 0.25 0.02 0.25 0.33 0.25 0.1 0.25 0.05 0.15 0.07 0.07 0.05 0 0.21 0.04 0.02 0.1 0.12 0.23 0.02 0.2 0.26 0.23 0.1 0.23 0.23 0.23 0.23 0.19 0.13 0.2 0.28 0.04 0.41 0.11 0.27 0.02 0.43 0.02 0.08 0.05 0.04 0.26 0.21 0 0.05 0.14 0.14 0.32 0.19 0.27 0.05 0.27 0.05 0.27 0.4 0.24 0.11 0.11 0.11 0.12 0.02 0.25 0.25 0.07 0.1 0.1 0.05 0.02 0.1 0 0.05 0.1 0.1 0.25 0.04 0 0.02 0.02 0.02 0.11 0.1 0.02 0.1 0.1 0.09 0.09 0.09 0.09 0.07 0.09 0.05 0.41 0.09 0.05 0.1 0.1 0.02 0.11 0.13 0.11 0.09 0.11 0.07 0.12 0.03 0 0.38 0.15 0.36 0.02 0.57 0.07 0.57 0.11 0 0.24 0.42 0.58 0.02 0.57 0.43 0.57 0.58 0.02 0.06 0.58 0.58 0.11 0.11 0.02 0.07 0.05 0.41 0.42 0 0.27 0.07 0.17 0.02 0.3 0.07 0.05 0.02 0.02 0.02 0.09 0.13 0.48 0.02 0.13 0.11 0.04 0.02 0 0.02 0.43 0.02 0.02 0 0.46 0.02 0.09 0.1 0.12 0.41 0.43 0.02 0.02 0.02 0.02 0.53 0.03 0.42 0.15 0.06 0.43 0.02 0.02 0.13 0.02 0.43 0 0.02 0.17 0.02 0 0 0.02 0.07 0.21];
%pos=[834 836 963 1014 1883 1975 2190 2278 2302 2313 2422 2526 2527 2528 2599 2933 2937 2945 2976 3413 3646 3727 3739 4121 4268 4453 4577 4613 4721 5815 6366 6379 6462 6572 7048 7071 7446 7464 8623 8870 8873 9147 9259 9367 9396 9483 10700 10940 10969 11164 11588 11710 11876 11975 12954 13199 13407 13454 13563 13573 13588 13612 13842 14342 14989 14991 15095 15590 15740 15834 15845 16182 16337 16364 16366 17549 17992 18377 18470 18620 18819 19008 19295 19473 19590 19889 19890 19910 20064 20207 20416 20505 20514 20620 20640 20772 20824 20846 20874 20883 20924 20937 20982 20985 21027 21053 21149 23669 23703 24189 24208 24235 24525 24833 25072 25099 25226 25256 25447 25722 25751 25752 25838 25879 25884 25974 25982 26076 26116 26177 26331 26495 26520 26578 26629 27159 27196 27678 27800 28281 28417 28423 28433 28473 28483 28521 28537 28609 28697 28735 28795 28859 28997 29026 29044 29109 29293 29363 29407 29440 29517 29868 29885 29891 30169 30238 30360 30415 30728 30729 30756 30887 31050 31147 31257 31260 31320 31531 31547 31555 31556 31699 31707 31715 31876 31910 31935 31937 31939 32068 32110 32188 32220 32221 32266 32405 32437 32546 32682 32701 32756 32819 32827 33174 33279 33374 33524 33616 33639 33821 33918 34281 34390 34413 34480 34483 34535 34667 34769 34885 34913 35086 35164 35267 35347 35532 35538 35548 36021 36176 36406 36488 36591 36697 36735 36750 36863 36947 36957 37287 37376 37450 37827 38089 38161 38383 38483 38538 38834 38908 38926 38931 39058 39069 39536 39654 39727 39807 40019 40124 40147 40310 40690 41130 41251 41744 41753 42171 42908 43078 43103 43118 43169 43170 43321 43810 43928 44059 44186 44207 44566 44692 44882 44949 45206 45444 45522 45796 45850 46001 46239];
%stem(pos,ffreq)

%prod(ffreq(ffreq>0))
CL=sum(log(ffreq(ffreq>0)));

v=version;
if(str2num(v(1))>6)
    %[t1,t2,ftype]=unique(ffreq);
    p=grpstats(ffreq,ffreq,@mode);
    k=grpstats(ffreq,ffreq,@numel);
else
    [p,sem,k,gname]=grpstats(ffreq',ffreq');
end
x=p.^sort(k);
CLmax=sum(log(x(x>0)));
%[a,b]=ismember(K,k)


if (nargout<1)
i_dispheader('Composite Likelihood of SNPs')
	fprintf (['Composite Likelihood (CL): %f\n'],CL);
	fprintf (['Max. Composite Likelihood (CL_max): %f\n'],CLmax);
i_dispfooter
end

