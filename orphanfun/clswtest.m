alle=[0 0 0 1 0 1 0 1 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1 0 1 0 0 0 1 0 1 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 
1 1 0 1 1 0 0 1 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0 0 0 0 1 0 0 0 1 1 1 0 0 0 0 0 0 1 0 0 0 1 
0 0 1 0 1 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 0 1 0 1 0 0 1 1 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0 
0 0 0 0 1 0 0 1 0 0 1 0 0 1 0 1 0 0 1 0 0 0 0 1 0 0 0 0 0 1 0 0 0 1 0 1 1 0 1 0 1 1 1 1 1 0 1 
1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 1 0 0 1 1 0 0 1 1 0 1 1 0 0 0 0 0 0 0 0 1 0 1 0 0 0 0 1 0 0 1 0 
0 0 0 1 1 0 0 0 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 0 1 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 
1 0 0 1 0 0 1 0 0 0 1 0 0 0 0 1 0 0 1 0 0 0 0 1 0 0 0 1 1 0 0 0 0 0 0 1 0 0 0 0 0 0 1 0 0 0 0 
0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1 0 0 1 0 0 1 1 0 1 1 0 0 0 0 0 1 1 0 1 0 0 0 1 
1 0 0 0 1 0 0 1 0 0 1 0 0 0 0 1 0 0 1 0 1 1 0 1 0 0 1 0 0 1 1 0 0 0 0 1 1 0 0 0 1 0 0 0 0 1 0 
0 0 0 1 0 0 1 0 1 1 0 1 1 0 1 0 1 1 1 1 0 0 0 0 1 0 1 0 0 1 1 0 0 0 0 1 1 0 0 0 1 0 0 0 0 0 0];


Sposn=[0.011200 0.037200 0.058300 0.064300 0.065400 0.078000 0.092400 0.307500 0.360200 0.363400...
 0.384000 0.396100 0.401600 0.407300 0.408700 0.430300 0.435000 0.625100 0.631600 0.636400...
 0.643800 0.648900 0.659800 0.670900 0.672700 0.685500 0.688200 0.689300 0.692000 0.693800...
 0.701700 0.702400 0.711600 0.717900 0.726200 0.728900 0.729300 0.733800 0.736100 0.738900...
 0.742700 0.745000 0.746600 0.890800 0.901300 0.911500 0.918000];
seqL=10000;

Sites = round(seqL*Sposn+0.5);

nsegm=[1 1000
2501 4500
6201 7600
8855 10000];

ncd=[131 780
2600 3200
9301 9945];

a1=sum(1./[1:10-1]);

lSeq=sum(nsegm(:,2)-nsegm(:,1)+1);
lCD=sum(ncd(:,2)-ncd(:,1)+1);
numSg=47;
r_the=0.3;

theta=numSg/(lSeq+lCD*(r_the-1))/a1;
thetav=zeros(1,10000);

Snmut=sum(alle);


for k=1:size(nsegm,1)
    thetav(nsegm(k,1):nsegm(k,2))=theta;
end
for k=1:size(ncd,1)
    thetav(ncd(k,1):ncd(k,2))=theta*r_the;
end


lnN=sum(log(thetav(Sites)./Snmut));

thetav(Sites)=[];
thetav(thetav==0)=[];
%thetax=thetav(1:lSeq-lCD);
lnN=lnN+sum(log(1-thetav*a1)) 





nSam=10;
S_count=hist(sum(alle),nSam-1);
lnP=sum(S_count.*log(binopdf(1:9,nSam,[1:9]./nSam)))
